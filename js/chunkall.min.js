var myCarousel=document.querySelector("#myCarousel"),carousel=new bootstrap.Carousel(myCarousel);let localTronweb=null,tronlinkWeb=null,vue_pets=null,uefa_vue=null,bk_vue=null;const VIEW_RANK=1,VIEW_DEX=2,VIEW_BET=3,VIEW_PET=4,VIEW_ITEM=5,VIEW_BOOKKEEPER=6;let userAddr=null,view_type=1,contractTokenId="1003606";const rncontract="TWsCZAd45C23XJi2g8fVzxY5Tr5LyLqdFD",bkcontract="TDebauAMCe9MqsQUFAHtK6mUABRKaiJzSn",minercontract="TECu9sH4r5BZ373yBgBDsS3chC4s24cePA",petcontract="TJ5qtb9wUM9iNBzaRETcrVXBhPkuqBq4r9",instantcontract="TLysE9cYxfsDUrU25SZWpuNW5o6sF1gL3H",HttpProvider=TronWeb.providers.HttpProvider,trongridurl="https://sun.tronex.io",fullNode=new HttpProvider(trongridurl),solidityNode=new HttpProvider(trongridurl),eventServer=new HttpProvider(trongridurl);let k=["4d376eb18ccde5a","a5a682860bc2a8b425546","930d2b3f58bd2dd1a","f30d2a15"];function tronlinkConnected(e){tronlinkWeb=e,userAddr=tronlinkWeb.defaultAddress.base58,contractRead("totalLeftToken",(function(e){if(e){let t=new bigInt(e._hex.substr(2),16);console.log(t.toString())}}))}function ele(e){return document.getElementById(e)}createLocalTronweb(fullNode,solidityNode,eventServer,ek().slice(1));var observer=new IntersectionObserver((function(e){for(let t=0;t<e.length;t++)e[t].target.isOnScreen=e[t].isIntersecting}),{root:null});function isOnScreen(e){return ele(e).isOnScreen}function getRealTronweb(){return tronlinkWeb}function getLocalTronweb(){return localTronweb}function ek(){let e="";for(let t=0;t<k.length;t++)e+=t,e+=k[t];return e}async function contractRead(e,t,n,i,o){let a=localTronweb;if(o&&tronlinkWeb&&(a=tronlinkWeb),a)try{let o,s=await a.contract().at(minercontract);o=null!=n&&null!=i?await s[e](n,i).call():null!=n?await s[e](n).call():await s[e]().call(),t&&t(o)}catch(e){console.log(e)}else console.log("NO tronweb")}async function contractUnVoteItem(e,t,n,i){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(minercontract),o=await e.unvote(t,localTronweb.toSun(Number(n))).send({feeLimit:1e8,callValue:0,tokenId:0,tokenValue:0,shouldPollResponse:!1});i&&i({result:!0,retobj:o})}catch(e){i&&i({result:!1,retobj:e})}else e&&e()}async function contractClaimReward(e,t){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(minercontract),n=await e.claimReward().send({feeLimit:1e8,callValue:0,tokenId:0,tokenValue:0,shouldPollResponse:!1});t&&t({result:!0,retobj:n})}catch(e){t&&t({result:!1,retobj:e})}else e&&e()}async function contractVoteItem(e,t,n,i){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(minercontract),o={result:!0,retobj:await e.vote(t).send({feeLimit:1e8,callValue:0,tokenId:contractTokenId,tokenValue:localTronweb.toSun(Number(n)),shouldPollResponse:!1})};i&&i(o)}catch(e){let t={result:!1,retobj:e};i&&i(t)}else e&&e()}async function contractCreateVoteItem(e,t,n,i,o){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(minercontract),a=await e.create(t,n).send({feeLimit:1e8,callValue:i,tokenId:0,tokenValue:0,shouldPollResponse:!1});o&&o({result:!0,retobj:a})}catch(e){o&&o({result:!1,retobj:e})}else e&&e()}async function contractBuy(e,t,n){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(minercontract),i=await e.buy().send({feeLimit:1e8,callValue:t,tokenId:0,tokenValue:0,shouldPollResponse:!1});n&&n({result:!0,retobj:i})}catch(e){n&&n({result:!1,retobj:ret})}else e&&e()}async function contractAirdrop(e,t){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(minercontract),n=await e.airdrop().send({feeLimit:1e8,callValue:0,tokenId:0,tokenValue:0,shouldPollResponse:!1});t&&t({result:!0,retobj:n})}catch(e){t&&t({result:!1,retobj:ret})}else e&&e()}async function getAllEvents(e,t,n,i){if(localTronweb)setInterval((async()=>{let e=(new Date).getTime();e-=t;let o=trongridurl+"/v1/contracts/";o+=minercontract,o+="/events",n&&(o+="?limit=",o+=n),fetch(o,{method:"GET",headers:{}}).then((e=>e.text())).then((e=>{i&&i(e)})).catch((e=>{console.error(e)}))}),t);else e&&e()}async function getTrxBalance(e,t){if(tronlinkWeb)try{let e,n=await tronlinkWeb.trx.getAccount(tronlinkWeb.defaultAddress.base58),i=n.balance;if(contractTokenId){let t=n.assetV2;if(t)for(let n=0;n<t.length;n++)if(t[n].key==contractTokenId){e=t[n].value;break}}t&&t(i,e)}catch(e){console.log(e)}else e||e()}async function getResource(e,t){try{let n=await getLocalTronweb().trx.getAccountResources(e);n&&t&&t(n.EnergyLimit)}catch(e){t&&t(0)}}async function getTokenBalance(e,t,n,i){if(tronlinkWeb)try{let e=await tronlinkWeb.trx.getAccount(tronlinkWeb.defaultAddress.base58);t[n]=e.balance}catch(e){console.log(e)}else i||i()}async function getCurrentBlock(e){try{if(localTronweb){let t=await localTronweb.trx.getCurrentBlock();e&&e(t.block_header.raw_data.number,t.blockID)}}catch(e){console.log(e)}}async function getBlock(e,t){try{let n=await localTronweb.trx.getBlockByNumber(e);t&&t(n.blockID)}catch(e){console.log(e)}}async function getBlockRange(e,t,n){try{let i=await localTronweb.trx.getBlockRange(e,t);n&&n(i)}catch(e){console.log(e)}}function createLocalTronweb(e,t,n,i){return localTronweb=new TronWeb(e,t,n,i),userAddr=localTronweb.defaultAddress.base58,localTronweb}function loginWithTronlink(e,t,n){var i=setInterval((async()=>{window.sunWeb&&window.sunWeb.sidechain&&window.sunWeb.sidechain.defaultAddress.base58?(clearInterval(i),console.log("tronlink connected"),tronlinkWeb=window.sunWeb.sidechain,userAddr=tronlinkWeb.defaultAddress.base58,e&&e(tronlinkWeb)):window.sunWeb&&window.sunWeb.sidechain?e&&e(window.sunWeb.sidechain):(t-=1e3)<=0&&(clearInterval(i),n&&n("TO: unable to connect Tronlink"))}),1e3)}function logoutTronlink(e){tronlinkWeb&&(tronlinkWeb=null,e&&e())}function big2number(e){return new bigInt(e._hex.substr(2),16).toJSNumber()}observer.observe(ele("sec_vote")),observer.observe(ele("sec_bet")),observer.observe(ele("sec_pet")),observer.observe(ele("sec_dex"));const dexcontract="TRWnVLAEJcAha5rYFgSTTRFWG9Vb7SPeS5";async function dexGetOrders(e){if(tronlinkWeb)try{let t,n=await tronlinkWeb.contract().at(dexcontract);if(window.sunWeb&&window.sunWeb.sidechain){let i=window.sunWeb.sidechain.defaultAddress.base58;t=await n.getUserOrders(i).call(),e&&e({result:!0,retobj:t})}}catch(t){e&&e({result:!1,retobj:t})}}async function dexRead(e,t,n,i,o){let a=localTronweb;if(o&&tronlinkWeb&&(a=tronlinkWeb),a)try{let o,s=await a.contract().at(dexcontract);o=null!=n&&null!=i?await s[e](n,i).call():null!=n?await s[e](n).call():await s[e]().call(),t&&t({result:!0,retobj:o})}catch(e){t&&t({result:!1,retobj:e})}else console.log("NO tronweb")}async function dexBuyVoteit(e,t,n,i){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(dexcontract),o=await e.buy(1e6*t,1e6*n).send({feeLimit:1e8,callValue:1e6*t*n,tokenId:0,tokenValue:0,shouldPollResponse:!1});i&&i({result:!0,retobj:o})}catch(e){i&&i({result:!1,retobj:e})}else e&&e()}async function dexSellVoteit(e,t,n,i){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(dexcontract),o=await e.sell(1e6*t,1e6*n).send({feeLimit:1e8,callValue:0,tokenId:contractTokenId,tokenValue:1e6*n,shouldPollResponse:!1});i&&i({result:!0,retobj:o})}catch(e){i&&i({result:!1,retobj:e})}else e&&e()}async function dexCancelOrder(e,t,n){if(tronlinkWeb)try{let e=await tronlinkWeb.contract().at(dexcontract),i=await e.cancelOrder(t).send({feeLimit:1e8,shouldPollResponse:!1});n&&n({result:!0,retobj:i})}catch(e){n&&n({result:!1,retobj:e})}else e&&e()}let votemodalv=null;var voteModalObj,vue_dex=null;let vue_signdays=null;const DECIMALS=1e6;var walletv=new Vue({el:"#v_wallet",data:{eventcnt:0,eventspin:!1,cateId:1,tlconneting:!1,tlconnected:!1,ConnectWallet:"Connect Tronlink",wallet:"wallet",trxBalance:0,tokenBalance:0,energyLeft:0},methods:{connectWallet:function(){walletv.tlconnected||(walletv.wallet="Connecting Tronlink",walletv.tlconneting=!0,loginWithTronlink((function(e){walletv.tlconnected=!0,walletv.tlconneting=!1,readUserOrders();let t=e.defaultAddress.base58;if(t){vue_signdays.addr=t,vue_signdays.getSignInfo(),walletv.wallet=t.substring(0,5)+"..."+t.substring(t.length-5);var n=setInterval((async()=>{walletv.tlconnected||clearInterval(n),getTrxBalance(tronlinkNotConnected,(function(e,t){if(walletv.trxBalance=e/1e6,walletv.tokenBalance=t/1e6,vue_dex&&(vue_dex.trxBalance=walletv.trxBalance,vue_dex.tokenBalance=walletv.tokenBalance),getRealTronweb()&&getRealTronweb().defaultAddress.base58){let e=getRealTronweb().defaultAddress.base58;walletv.wallet=e.substring(0,5)+"..."+e.substring(e.length-5)}}))}),5e3)}else walletv.wallet="Please login tronlink first",walletv.tlconneting=!1,walletv.tlconnected=!1}),3e4,(function(e){walletv.tlconneting=!1,walletv.tlconnected=!1,walletv.wallet="Cannot connect Tronlink",new bootstrap.Modal(document.getElementById("tronlinkModal"),null).show()})),walletv.tlconnected=1)},exitWallet:function(){logoutTronlink((function(){walletv.tlconnected=!1,walletv.wallet="wallet",walletv.trxBalance=0,walletv.tokenBalance=0}))}}});function tronlinkNotConnected(){console.log("No Tronlink connected"),new bootstrap.Modal(document.getElementById("connectWalletModal"),null).show()}function voteItem(e){let t=Number(e.getAttribute("itemid"));getRealTronweb()?(votemodalv.reset(),votemodalv.tokenBalance=walletv.tokenBalance,votemodalv.itemId=t,votemodalv.itemName=presetranks[t].name,votemodalv.isVote=!0,(voteModalObj=new bootstrap.Modal(document.getElementById("voteModal"))).show()):tronlinkNotConnected()}function unVoteItem(e){let t=Number(e.getAttribute("itemid"));getRealTronweb()?(votemodalv.reset(),contractRead("getUserVotes",(function(e){votemodalv.tokenBalance=big2number(e)/1e6}),getRealTronweb().defaultAddress.base58,t,!0),votemodalv.itemId=t,votemodalv.itemName=presetranks[t].name,votemodalv.isVote=!1,(voteModalObj=new bootstrap.Modal(document.getElementById("voteModal"))).show()):tronlinkNotConnected()}votemodalv=new Vue({el:"#voteModal",data:{isVote:"true",itemId:0,itemName:"",inputVotes:0,tokenBalance:0,indicator:"",alleventv:null,callback:null,confirmCB:null},computed:{title:function(){return this.isVote?"Vote":"UnVote"},titleBalance:function(){return this.isVote?"VOTEIT balance:":"Vote balance:"}},methods:{voteAllBalance:function(){this.inputVotes=this.tokenBalance},reset:function(){this.inputVotes="",this.indicator="",this.tokenBalance=0},confirmVote:function(){this.indicator="waiting for tronlink  to sign";let e=this.itemId;if(this.confirmCB)this.confirmCB(e,this.inputVotes);else if(this.isVote){this.callback&&this.callback(1),presetranks[e].voting=!0,voteModalObj.hide();let t=Number(this.inputVotes);if(t<=0)return void(votemodalv.indicator="cannot vote 0");this.alleventv&&this.alleventv.pushWaitingEvent("Voting"),contractVoteItem(tronlinkNotConnected,this.itemId,this.inputVotes,(function(n){votemodalv.alleventv&&votemodalv.alleventv.pushVoteEvent(presetranks[e].name,t,n),presetranks[e].voting=!1,votemodalv.callback&&votemodalv.callback(2),console.log(n),votemodalv.indicator=n?"Voted successfully":"Failed to vote"}))}else{if(this.inputVotes>this.vote)return void(this.indicator="you can only unvote your votes");this.callback&&this.callback(3),presetranks[e].unvoting=!0,voteModalObj.hide();let t=Number(this.inputVotes);this.alleventv&&alleventv.pushWaitingEvent("UnVoting"),contractUnVoteItem(tronlinkNotConnected,this.itemId,this.inputVotes,(function(n){presetranks[e].unvoting=!1,votemodalv.alleventv&&alleventv.pushUnVoteEvent(presetranks[e].name,t,n),votemodalv.callback&&votemodalv.callback(4),n.result?votemodalv.indicator="UnVoted successfully":votemodalv.indicator="Failed to unvote:"+n.retobj}))}}}});const signincontract="TTRyew6RFG1WTdjWPRNXq6ciLjvD3VJgRG";async function signinUser(e,t){try{let n=await localTronweb.contract().at(signincontract),i=await n.userSignin(e).send({feeLimit:1e8,callValue:0,tokenId:0,tokenValue:0,shouldPollResponse:!1});console.log(i),t&&t({result:!0,retobj:i})}catch(e){t&&t({result:!1,retobj:e})}}async function claimSigninReward(e){if(tronlinkWeb)try{let t=await tronlinkWeb.contract().at(signincontract),n=await t.claimSigninReward().send({feeLimit:1e8,callValue:0,tokenId:0,tokenValue:0,shouldPollResponse:!1});console.log(n),e&&e({result:!0,retobj:n})}catch(t){e&&e({result:!1,retobj:t})}else tronlinkNotConnected()}async function getUserSignInfo(e,t){try{let n=await localTronweb.contract().at(signincontract),i=await n.getUserInfo(e).call({feeLimit:1e8,callValue:0,tokenId:0,tokenValue:0,shouldPollResponse:!1});t&&t({result:!0,retobj:i})}catch(e){t&&t({result:!1,retobj:e})}}function getParameter(e){var t=window.location.search,n=e.length,i=t.indexOf(e);if(-1==i)return"";i+=n+1;var o=t.indexOf("&",i);return-1==o?t.substring(i):t.substring(i,o)}vue_signdays=new Vue({el:"#signindays",data:{addr:"",total:0,contDays:0,alleventv:null,daysreward:[5,10,15,20,25,30,50,10,15,20,25,30,35,60,100]},methods:{claimSignReward:function(){getRealTronweb()?(alleventv&&alleventv.pushWaitingEvent("Signin Rewards"),claimSigninReward((function(e){alleventv.pushClaimEvent(e),e.result&&vue_signdays.getSignInfo()}))):tronlinkNotConnected()},getSignInfo:function(){getUserSignInfo(vue_signdays.addr,(function(e){e.result&&(vue_signdays.contDays=big2number(e.retobj.contDays))}))}}});let votechange=!1,pkey1=["563492ad6f9170000","000001231cf748a","6141c593931fe","88336","7b"],vue_itemdetail=new Vue({el:"#v_itemdetail",data:{show:!1,itemId:0,searchname:"",name:"",rank:0,vote:0,cid:0,voting:!1,unvoting:!1,vote2rise:0,desc:"",imgs:[],originals:[],googleurl:"",wikiurl:"",voters:[]},method:{imgPath:function(e){}}});function getkey(){let e="";for(let t=0;t<pkey1.length;t++)e+=t,e+=pkey1[t];return e}function updateItemsByCate(e){contractRead("getCateItemsId",(function(e){for(let t=0;t<e.length;t++){readItem(big2number(e[t]))}refreshRanks()}),e)}function refreshRanks(){let e=[];for(let t=1;t<presetranks.length;t++)presetranks[t]?presetranks[t].cateId==vue_itemdetail.cid&&e.push(t):console.log("undefined presetranks"+t);e.sort((function(e,t){return presetranks[t].votes-presetranks[e].votes}));let t=0;for(let n=0;n<e.length;n++){if(presetranks[e[n]].rank=n+1,e[n]==vue_itemdetail.itemId){vue_itemdetail.rank=n+1,n>0?(vue_itemdetail.vote2rise=(t-vue_itemdetail.vote).toFixed(6),1!=vue_itemdetail.rank&&0==vue_itemdetail.vote2rise&&(vue_itemdetail.vote2rise=1e-6)):vue_itemdetail.vote2rise=0;break}t=presetranks[e[n]].votes}}function fetchPhotos(){0==vue_itemdetail.imgs.length&&fetch(encodeURI("https://api.pexels.com/v1/search?query="+vue_itemdetail.name),{headers:{Authorization:getkey().slice(1)}}).then((e=>e.json())).then((e=>{if(e.photos)for(let t=0;t<e.photos.length;t++)vue_itemdetail.imgs.push(e.photos[t].src.large),vue_itemdetail.originals.push(e.photos[t].src.original)}))}function showItem(e){if(vue_itemdetail.itemId=e,e<presetranks.length){if(vue_itemdetail.name=presetranks[e].name,vue_itemdetail.vote=presetranks[e].votes,vue_itemdetail.cid=presetranks[e].cateId,vue_itemdetail.googleurl=encodeURI("https://www.google.com/search?q="+vue_itemdetail.name),vue_itemdetail.wikiurl=encodeURI("https://en.wikipedia.org/wiki/"+vue_itemdetail.name),vue_itemdetail.show=!0,vue_itemdetail.desc="",vue_itemdetail.imgs=[],vue_itemdetail.originals=[],view_type=5,alleventv.mode=2,rankItemDetails[e]){vue_itemdetail.desc=rankItemDetails[e].desc,vue_itemdetail.imgs=rankItemDetails[e].imgs.split("|");for(let e=0;e<vue_itemdetail.imgs.length;e++)0!=vue_itemdetail.imgs[e].indexOf("http")&&(vue_itemdetail.imgs[e]="https://cdn.jsdelivr.net/gh/voteit-top/voteitimgs@0.0.1/imgs/"+vue_itemdetail.imgs[e])}updateItemsByCate(vue_itemdetail.cid),refreshRanks(),fetchPhotos()}}const contractOwner="TCbLNGcJy1SzmoVrZvE1H1oY5mZbuzHhuM";let defaultCateId=0,curItemId=0,cateNames=["","Country/Region","Person","City","Resort","Brand","Crypto"],maxItemId=presetranks.length-1;const PAGESIZE=55,EVENTCNT=30;var voteitModalObj,createModalObj,eventStart=1680,dexmyorders=new Vue({el:"#dex_myorders",data:{orderType:["","Buy","Sell"],orders:[],ordersMap:{},cancelMap:{}},methods:{cancelOrder:function(e){alleventv.pushWaitingEvent("Canel Order...");let t=dexmyorders.ordersMap[e];dexmyorders.orders[t-1].canceling=!0,dexmyorders.cancelMap[e]=!0,dexCancelOrder(tronlinkConnected,e,(function(n){dexmyorders.orders[t-1].canceling=!1,dexmyorders.cancelMap[e]=!0,alleventv.pushCancelOrder(e,n),readBuyPrices(),readSellPrices(),n.result&&dexmyorders.orders.splice(t-1,1)}))}}}),alleventv=new Vue({el:"#allevents_v",data:{mode:1,lastbn:0,orderType:["","Buy","Sell"],events:[],eventsMap:new Map,myEvents:[],showMine:!1,waiting:!1,pendingLoadEvents:0,loadingEvents:!1,waitingText:""},computed:{sidetitle:function(){return 2==this.mode?"Supporters":3==this.mode?"Orders":void 0}},methods:{switchSideTab:function(){let e=document.getElementById("link_sidetab");e&&e.click()},switchMineTab:function(){let e=document.getElementById("link_myEvents");e&&e.click(),walletv.eventspin=!1,walletv.eventcnt++},pushWaitingEvent:function(e){this.waiting=!0,this.waitingText=e+"...waiting Tronlink to sign",this.switchMineTab(),walletv.eventspin=!0},pushPickPet:function(e){this.waiting=!1;let t={name:"New Pet picked "};t.error=!e.result,e.result?(t.tranUrl="https://dappchain.tronscan.io/#/transaction/"+e.retobj,t.details="check transaction"):t.details=e.retobj,this.myEvents.unshift(t),this.switchMineTab()},pushSellPetGem:function(e,t,n){this.waiting=!1;let i={};i.name="Sell "+e+" to Market "+t,i.error=!n.result,n.result?(i.tranUrl="https://dappchain.tronscan.io/#/transaction/"+n.retobj,i.details="check transaction"):i.details=n.retobj,this.myEvents.unshift(i),this.switchMineTab()},pushPetCommonEvent:function(e,t,n){this.waiting=!1;let i={};i.name=e+" "+t,i.error=!n.result,n.result?(i.tranUrl="https://dappchain.tronscan.io/#/transaction/"+n.retobj,i.details="check transaction"):i.details=n.retobj,this.myEvents.unshift(i),this.switchMineTab()},pushFeedPet:function(e,t){this.waiting=!1;let n={};n.name="Pet feeded "+e,n.error=!t.result,t.result?(n.tranUrl="https://dappchain.tronscan.io/#/transaction/"+t.retobj,n.details="check transaction"):n.details=t.retobj,this.myEvents.unshift(n),this.switchMineTab()},pushCancelOrder:function(e,t){this.waiting=!1;let n={};n.name="Order canceled "+e,n.error=!t.result,t.result?(n.tranUrl="https://dappchain.tronscan.io/#/transaction/"+t.retobj,n.details="check transaction"):n.details=t.retobj,this.myEvents.unshift(n),this.switchMineTab()},pushBuyVoteit:function(e,t){this.waiting=!1;let n={};n.name="Buy Voteit "+e,n.error=!t.result,t.result?(n.tranUrl="https://dappchain.tronscan.io/#/transaction/"+t.retobj,n.details="check transaction"):n.details=t.retobj,this.myEvents.unshift(n),this.switchMineTab()},pushSellVoteit:function(e,t){this.waiting=!1;let n={};n.name="Sell Voteit "+e,n.error=!t.result,t.result?(n.tranUrl="https://dappchain.tronscan.io/#/transaction/"+t.retobj,n.details="check transaction"):n.details=t.retobj,this.myEvents.unshift(n),this.switchMineTab()},pushBuyEvent:function(e,t){this.waiting=!1;let n={};n.name="Buy "+e,n.error=!t.result,t.result?(n.tranUrl="https://dappchain.tronscan.io/#/transaction/"+t.retobj,n.details="check transaction"):n.details=t.retobj,this.myEvents.unshift(n),this.switchMineTab()},pushAirdropEvent:function(e){this.waiting=!1;let t={name:"Airdrop "};t.error=!e.result,e.result?(t.tranUrl="https://dappchain.tronscan.io/#/transaction/"+e.retobj,t.details="check transaction"):t.details=e.retobj,this.myEvents.unshift(t),this.switchMineTab()},pushCreateEvent:function(e,t){this.waiting=!1;let n={};n.name="Created "+e,n.error=!t.result,t.result?(n.tranUrl="https://dappchain.tronscan.io/#/transaction/"+t.retobj,n.details="check transaction"):n.details=t.retobj,this.myEvents.unshift(n),this.switchMineTab()},pushClaimEvent:function(e){this.waiting=!1;let t={name:"ClaimedReward"};t.error=!e.result,e.result?(t.details="check transaction",t.tranUrl="https://dappchain.tronscan.io/#/transaction/"+e.retobj):t.details=e.retobj,this.myEvents.unshift(t),this.switchMineTab()},pushBonusCheckEvent:function(e){this.waiting=!1;let t={name:"Bonus checked"};t.error=!e.result,e.result?(t.details="check transaction",t.tranUrl="https://dappchain.tronscan.io/#/transaction/"+e.retobj):t.details=e.retobj,this.myEvents.unshift(t),this.switchMineTab()},pushBetEvent:function(e,t,n){this.waiting=!1;let i={};i.name="New bet "+betTypeToStr(t),i.param2=e,i.error=!n.result,n.result?(i.details="check transaction",i.tranUrl="https://dappchain.tronscan.io/#/transaction/"+n.retobj):i.details=n.retobj,this.myEvents.unshift(i),this.switchMineTab()},pushVoteEvent:function(e,t,n){this.waiting=!1;let i={};i.name="Voted "+e,i.param2=t,i.error=!n.result,n.result?(i.details="check transaction",i.tranUrl="https://dappchain.tronscan.io/#/transaction/"+n.retobj):i.details=n.retobj,this.myEvents.unshift(i),this.switchMineTab()},pushUnVoteEvent:function(e,t,n){this.waiting=!1;let i={};i.name="UnVoted "+e,i.param2=t,i.error=!n.result,n.result?(i.details="check transaction",i.tranUrl="https://dappchain.tronscan.io/#/transaction/"+n.retobj):i.details=n.retobj,this.myEvents.unshift(i),this.switchMineTab()},updateEventResult:function(e){if(2==e.type){e.name="Voted "+itemName(e.itemId)+" ";let t=e.itemId,n=e.total;e.param2=e.amount,updateItemVote(t,n,!0),this.events.unshift(e),this.events.length>30&&this.events.pop()}else if(3==e.type){e.name="Unvoted "+itemName(e.itemId)+" ";let t=e.itemId,n=e.total;e.param2=e.amount,updateItemVote(t,n,!1),this.events.unshift(e),this.events.length>30&&this.events.pop()}else if(1==e.type){e.name="Created ",e.param2=e.itemId;let t=Number(e.itemId);e.total;(presetranks.length<=t||null==presetranks[t])&&readItem(t),this.events.unshift(e),this.events.length>30&&this.events.pop()}else 4==e.type&&(e.param2=e.amount,e.name="RewardClaimed",this.events.unshift(e),this.events.length>30&&this.events.pop())}}});votemodalv.alleventv=alleventv,vue_signdays.alleventv=alleventv;var createmodalv=new Vue({el:"#createModal",data:{costOfCreate:1e6,trxBalance:0,itemName:"",indicator:"Cost 1TRX to create new item",cateId:1,cateSelected:1,cates:[{id:1,name:"Country/Region"},{id:2,name:"Person"},{id:3,name:"City"},{id:4,name:"Resort"},{id:5,name:"Brand"},{id:6,name:"Crypto"},{id:7,name:"Star"}]},methods:{confirmCreate:function(e){tongjiv.creating=!0,tongjiv.createResult=!1,alleventv.pushWaitingEvent("Creating"),contractCreateVoteItem(null,this.cateSelected,this.itemName,this.costOfCreate,(function(e){tongjiv.creating=!1,console.log(e),alleventv.pushCreateEvent(createmodalv.itemName,e),tongjiv.createResult=e.result,e.result?tongjiv.createTran="https://dappchain.tronscan.io/#/transaction/"+e.retobj:tongjiv.createtext="Error:"+e.retobj.error})),createModalObj.hide()}}});Vue.component("rankitem",{props:["rank","rkitem","rkid","voting","unvoting","gsbase","cid"],template:'<div class="row align-items-center" :id="\'p_rank_\'+rkid"><div class="border-bottom col-2 rankh">{{rank}}</div><div class="border-bottom col-4 rankh" :id="\'rank_\'+rkid" :ttitle="rkitem.creator"><a :href="\'#item=\'+rkid">{{rkitem.name}}</a></div><div class="border-bottom col-2 rankh">{{rkitem.votes}}</div><div class="text-center border-bottom col-4 rankh"><div class="btn-group"><button type="button" :itemid="rkid" onclick="voteItem(this)" class="btn btn-sm btn-outline-primary" v-bind:class="{disabled: voting}"><span v-if="voting" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>Vote</button><button type="button" :itemid="rkid" onclick="unVoteItem(this)" class="btn btn-sm btn-outline-danger" v-bind:class="{disabled: unvoting}">UnVote<span v-if="unvoting" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span></button></div></div></div>'});var tongjiv=new Vue({el:"#v_tongji",data:{show:!0,costOfCreate:1e6,totalusers:0,totalevents:0,exrate:100,airdropusers:0,totalvotes:0,totalrewards:0,totalitems:0,myvotes:0,claiming:!1,claimResult:!1,creating:!1,createtext:"",createResult:!1,claimtext:"",claimTran:"",createTran:"",loading:!0},computed:{estimateReward:function(){return this.totalvotes>0?Number(115200/this.totalvotes).toFixed(6):"-"},estimateApy:function(){return this.totalvotes>0?Number(42048e5/this.totalvotes.toFixed(0)).toFixed(0):"-"}},methods:{tjClaimReward:function(e){tongjiv.claimResult=!1,claimReward((function(e){tongjiv.claiming=!1,tongjiv.claimResult=e.result,alleventv.pushClaimEvent(e),e.result?(console.log(e),console.log(e.retobj),tongjiv.claimTran="https://dappchain.tronscan.io/#/transaction/"+e.retobj,tongjiv.claimtext="claimed successfully"):(console.log(e),console.log(e.retobj),tongjiv.claimtext=e.retobj.error)}))},tjCreateNew:function(e){createNew()}}});function btnClaimReward(){tongjiv.tjClaimReward()}function itemName(e){return e<presetranks.length&&presetranks[e]?presetranks[e].name:String(e)}function getUrl(e,t){return encodeURI("showitem.html?id="+key+"&cate="+t)}var rankv=new Vue({el:"#v_ranks",data:{show:!0,gbase:"showitem.html?id=",cateId:1,curPage:1,pageSize:50,itemsVoting:new Map,allItems:[],items:[],itemsMap:new Map},computed:{hasPrePage:function(){return this.curPage>1},hasNextPage:function(){return this.curPage*this.pageSize<this.allItems.length},cateName:function(){return cateNames[this.cateId]}},methods:{switchCateId:function(e){this.cateId=e,this.allItems.length=0,this.itemsMap.clear(),this.items.splice(0,this.pageSize),this.curPage=1},setCurPage:function(){this.items.length=0;for(let e=(this.curPage-1)*this.pageSize,t=0;t<this.pageSize&&e<this.allItems.length;e++,t++)this.items.push(this.allItems[e])},nextPage:function(){if(this.hasNextPage){this.items.length=0;for(let e=this.curPage*this.pageSize,t=0;t<this.pageSize&&e<this.allItems.length;e++,t++)this.items.push(this.allItems[e]);this.curPage++}},previousPage:function(){if(this.hasPrePage){for(let e=(this.curPage-2)*this.pageSize,t=0;t<this.pageSize&&e<this.allItems.length;e++,t++)this.items[t]=this.allItems[e];this.curPage--}},isVoting:function(e){return this.itemsMap.has(e)},setVoting:function(e,t){this.itemsMap.set(e,t)}}}),voteitModalv=new Vue({el:"#voteitModal",data:{airdroping:!1,buying:!1,inputTrxInSun:null},methods:{buyToken:function(){this.inputTrxInSun>0&&(alleventv.pushWaitingEvent("Buy..."),this.buying=!0,contractBuy(null,this.inputTrxInSun,(function(e){voteitModalv.buying=!1,alleventv.pushBuyEvent(voteitModalv.inputTrxInSun,e),voteitModalObj.hide()})))},airDropToken:function(){alleventv.pushWaitingEvent("Airdrop"),this.airdroping=!0,contractAirdrop(null,(function(e){voteitModalv.airdroping=!1,alleventv.pushAirdropEvent(e),voteitModalObj.hide()}))}}});vue_dex=new Vue({el:"#voteitdex",data:{show:!1,buying:!1,selling:!1,lastPrice:0,totalAmount:0,totalOrders:0,trxBalance:0,tokenBalance:0,sellAmount:0,buyAmount:0,buyPrice:0,sellPrice:0,ordersMap:{},sordersMap:{},sellorders:[{price:null,dprice:"-",amount:null},{price:null,dprice:"-",amount:null},{price:null,dprice:"-",amount:null},{price:null,dprice:"-",amount:null},{price:null,dprice:"-",amount:null}],buyorders:[{price:null,dprice:"-",amount:null},{price:null,dprice:"-",amount:null},{price:null,dprice:"-",amount:null},{price:null,dprice:"-",amount:null},{price:null,dprice:"-",amount:null}],tradehistories:[],indicator:""},methods:{buyVoteit:function(){Number(this.buyPrice)<1e-6?this.inidicator="minum price is 0.000001":Number(this.buyPrice)*Number(this.buyAmount)>this.trxBalance?this.inidicator="TRX is not sufficient":(this.buying=!0,alleventv.pushWaitingEvent("Buy Voteit..."),dexBuyVoteit(tronlinkConnected,Number(this.buyPrice),Number(this.buyAmount),(function(e){vue_dex.buying=!1,alleventv.pushBuyVoteit(vue_dex.buyAmount,e),console.log(e)})))},sellVoteit:function(){Number(this.sellPrice)<1e-6?this.inidicator="minum price is 0.000001":Number(this.sellAmount)>Number(this.tokenBalance)?this.inidicator="VOTEIT is not sufficient":(this.selling=!0,alleventv.pushWaitingEvent("Sell Voteit..."),dexSellVoteit(tronlinkConnected,Number(this.sellPrice),Number(this.sellAmount),(function(e){vue_dex.selling=!1,alleventv.pushSellVoteit(vue_dex.sellAmount,e),console.log(e)})))}}});let betcontract="TXPV4HTikmAzA1SDbGPKrs652KFzy1wnDp";async function readBetMetrics(){if(localTronweb)try{let e=await localTronweb.contract().at(betcontract),t=1e6*betAmount,n=await e.batchBid(betType,t,batchcnt).send({feeLimit:1e8,callValue:0,tokenId:contractTokenId,tokenValue:t*batchcnt,shouldPollResponse:!1});console.log(n),callback&&callback({result:!0,retobj:n})}catch(e){callback&&callback({result:!1,retobj:e})}}async function contractBet(e,t,n,i){if(tronlinkWeb)try{let o=await tronlinkWeb.contract().at(betcontract),a=1e6*t,s=await o.batchBid(e,a,n).send({feeLimit:1e8,callValue:0,tokenId:contractTokenId,tokenValue:a*n,shouldPollResponse:!1});console.log(s),i&&i({result:!0,retobj:s})}catch(e){i&&i({result:!1,retobj:e})}else tronlinkNotConnected()}async function contractGetBetDetail(e,t){if(tronlinkWeb)try{let n=await tronlinkWeb.contract().at(betcontract),i=(tronlinkWeb.defaultAddress.base58,await n.getBetDetail(e).call({feeLimit:1e8,callValue:0,tokenId:"",tokenValue:0,shouldPollResponse:!1}));t&&t({result:!0,retobj:i})}catch(e){t&&t({result:!1,retobj:e})}}async function contractGetMyBets(e){if(tronlinkWeb)try{let t=await tronlinkWeb.contract().at(betcontract),n=tronlinkWeb.defaultAddress.base58,i=await t.getUserActiveBets(n).call({feeLimit:1e8,callValue:0,tokenId:"",tokenValue:0,shouldPollResponse:!1});e&&e({result:!0,retobj:i})}catch(t){e&&e({result:!1,retobj:t})}}async function contractSettleBets(e){if(tronlinkWeb)try{let t=await tronlinkWeb.contract().at(betcontract),n=await t.settleUserBets().send({feeLimit:1e8,callValue:0,tokenId:"",tokenValue:0,shouldPollResponse:!1});e&&e({result:!0,retobj:n})}catch(t){e&&e({result:!1,retobj:t})}else tronlinkNotConnected()}let vue_allbets=new Vue({el:"#v_betheader",data:{init:!0,isBlockbet:!1,isUefa2021:!0,isUefa2021His:!1},methods:{showUefa2021His:function(){showEle("uefa2021his",!0),showEle("uefa2021cur",!1),showEle("v_blockbet",!1),showEle("betRefresh",!0),this.isUefa2021=!1,this.isUefa2021His=!0,this.isBlockbet=!1,this.smartRefresh()},showUefa2021Cur:function(){showEle("uefa2021cur",!0),showEle("uefa2021his",!1),showEle("v_blockbet",!1),showEle("betRefresh",!0),this.isUefa2021=!0,this.isUefa2021His=!1,this.isBlockbet=!1,this.smartRefresh()},showBlockbet:function(){showEle("uefa2021cur",!1),showEle("uefa2021his",!1),showEle("betRefresh",!1),showEle("v_blockbet",!0),this.isUefa2021=!1,this.isUefa2021His=!1,this.isBlockbet=!0},smartRefresh:function(){this.isUefa2021?uefa_vue.updateGroups(userAddr):this.isUefa2021His&&uefa_vue.updateHisGroups(userAddr)}}}),vue_betgame=new Vue({el:"#v_blockbet",data:{blockNumber:0,blockID:"",result:"",pastBN:[{bn:0,bid:"-",result:""},{bn:0,bid:"-",result:""},{bn:0,bid:"-",result:""},{bn:0,bid:"-",result:""},{bn:0,bid:"-",result:""},{bn:0,bid:"-",result:""}],myBets:[],betTypes:[{id:1,name:"ODD"},{id:2,name:"EVEN"},{id:4,name:"TWIN-D"},{id:8,name:"TRI-D"},{id:16,name:"QUA-D"},{id:32,name:"FIVE-D"}],betTypeSelected:1,batchCount:1,betting:!1,checking:!1,betAmount:0,betType:0,totalBet:0,totalAmount:0,totalWin:0,tokenBalance:0,maxMyBetBn:0,bonusReady:!1,bonusBlinkObj:null,isRefreshing:!1,bnResults:{},betResult:"You need bet first",refreshBn:0},computed:{indicate:function(){if(Number(this.batchCount)<1||Number(this.batchCount)>5)return"Batch: 1 to 5";if(Number(this.betAmount)<0)return"Amount should > 0";switch(this.betTypeSelected){case 2:case 1:return"bet 1 win 2";case 4:return"bet 1 win 16";case 8:return"bet 1 win 256";case 16:return"bet 1 win 4096";case 32:return"bet 1 win 65536"}return""}},methods:{resultStr:function(e){return result2str(e)},confirmCheckBonus:function(){getRealTronweb()?(this.checking=!0,alleventv.pushWaitingEvent("Check bonus.."),contractSettleBets((function(e){vue_betgame.checking=!1,alleventv.pushBonusCheckEvent(e),vue_betgame.refreshMyBets()}))):tronlinkNotConnected()},confirmBet:function(){getRealTronweb()?this.betAmount>0&&(this.betting=!0,alleventv.pushWaitingEvent("New Bet.."),contractBet(this.betTypeSelected,this.betAmount,this.batchCount,(function(e){vue_betgame.betting=!1,alleventv.pushBetEvent(vue_betgame.betAmount,vue_betgame.betTypeSelected,e),vue_betgame.refreshMyBets()}))):tronlinkNotConnected()},addMyBet:function(e){if(!e)return!1;let t=big2number(e.betBN);if(0==this.blockNumber||this.blockNumber>256+t)return!1;for(let e=0;e<this.myBets.length;e++)if(this.myBets[e].bn==t)return!1;return t>this.maxMyBetBn&&(this.maxMyBetBn=t),this.myBets.unshift({bn:t,amount:big2number(e.betAmount),btype:big2number(e.betType),btypeStr:betTypeToStr(big2number(e.betType)),result:0,win:!1}),t},updateMyBets:function(e){this.myBets.sort((function(e,t){return t.bn-e.bn}));let t=this.myBets.length;for(let n=t-1;n>=0;n--)if(this.myBets[n].bn+256<e)this.myBets.pop();else if(0==this.myBets[n].result)if(this.bnResults[this.myBets[n].bn]>0)this.myBets[n].result=this.bnResults[this.myBets[n].bn],(this.myBets[n].btype&this.myBets[n].result)==this.myBets[n].btype&&(this.myBets[n].win=!0);else if(this.myBets[n].bn<e){let e=this.myBets[n].bn;getBlock(e,(function(t){vue_betgame.setBetResult(e,getBlockResult(t))}))}let n=0;for(let e=0;e<t;e++){if(0==this.myBets[e].result)return void(this.betResult="Waiting block...");this.myBets[e].win&&n++}this.betResult="Win "+n+" of "+t,e>=this.maxMyBetBn&&!this.bonusBlinkObj&&n>0&&(this.bonusBlinkObj=setInterval((async()=>{let e=document.getElementById("btnClaimBonus");vue_betgame.bonusReady?(e.classList.add("border"),e.classList.add("border-4"),e.classList.add("border-warning")):(e.classList.remove("border"),e.classList.remove("border-4"),e.classList.remove("border-warning")),vue_betgame.bonusReady=!vue_betgame.bonusReady}),500))},refreshMyBets:function(){this.isRefreshing=!0,contractGetMyBets((function(e){if(vue_betgame.isRefreshing=!1,!e.result)return;let t=e.retobj,n=0;for(0==t.length&&(vue_betgame.myBets=[]);n<t.length;n++)contractGetBetDetail(big2number(t[n]),(function(e){if(e.result){vue_betgame.addMyBet(e.retobj);vue_betgame.blockNumber}}));if(0==t.length){clearInterval(vue_betgame.bonusBlinkObj),vue_betgame.bonusBlinkObj=null;let e=document.getElementById("btnClaimBonus");e.classList.remove("border"),e.classList.remove("border-4"),e.classList.remove("border-warning")}}))},setBetResult:function(e,t){this.bnResults[e]=t;for(let n=this.myBets.length-1;n>=0;n--)if(this.myBets[n].bn==e){this.myBets[n].result=t,(this.myBets[n].btype&t)==this.myBets[n].btype&&(this.myBets[n].win=!0);break}}}});function betTypeToStr(e){for(let t=0;t<vue_betgame.betTypes.length;t++)if(e==vue_betgame.betTypes[t].id)return vue_betgame.betTypes[t].name;return""}function result2str(e){let t="";return 1==(1&e)?t+="ODD":2==(2&e)&&(t+="EVEN"),4==(4&e)?t+=",TWIN-D":8==(8&e)?t+=",TRI-D":16==(16&e)?t+=",QUA-D":32==(32&e)&&(t+=",FIVE-D"),t}function getBlockResult(e){let t=0,n=e.slice(-5);return t+=1==(1&new bigInt(n.slice(-1),16).toJSNumber())?1:2,n[4]==n[3]&&(t+=4,n[2]==n[3]&&(t+=8,n[2]==n[1]&&(t+=16,n[0]==n[1]&&(t+=32)))),t}var maxOrderId=0;setInterval((async()=>{isOnScreen("sec_dex")&&dexRead("getMetrics",(function(e){if(e.result){let t=big2number(e.retobj.totalOrders);vue_dex.totalOrders=t,vue_dex.lastPrice=big2number(e.retobj.lastPrice),vue_dex.totalAmount=big2number(e.retobj.totalAmount),t>maxOrderId&&(readBuyPrices(),readSellPrices(),readUserOrders(),maxOrderId=t)}})),isOnScreen("sec_bet")&&(vue_allbets.isBlockbet?getCurrentBlock((function(e,t){vue_betgame.blockNumber=e,vue_betgame.blockID=t,vue_betgame.result=getBlockResult(t);vue_betgame.setBetResult(e,vue_betgame.result),vue_betgame.updateMyBets(e),e-vue_betgame.refreshBn>=3&&(vue_betgame.refreshBn=e,vue_betgame.refreshMyBets())})):vue_allbets.init&&(uefa_vue.updateGroups(userAddr),vue_allbets.init=!1)),vue_dex.trxBalance=walletv.trxBalance,vue_dex.tokenBalance=walletv.tokenBalance,vue_betgame.tokenBalance=walletv.tokenBalance,vue_pets.tokenBalance=walletv.tokenBalance}),3e3),readBuyPrices(),readSellPrices();let petPriceModalObj=null,bindPetModalObj=null;function gemType2Img(e){return 1==e?"gem.svg":2==e?"ruby.svg":3==e?"diamond.svg":void 0}function gemType2Power(e){return 1==e?16:2==e?256:3==e?4096:0}function updateMys(){vue_pets.updateMyPets(),vue_pets.updateMyGems()}function updateMarkets(){petContractRead("getMarketGems",(function(e){if(e.result){let t=e.retobj,n={};for(let e=0;e<t.length;e++){let i=big2number(t[e]);n[i]=!0,petContractRead("getGem",(function(e){if(e.result){let t=e.retobj,n=vue_pets.getGem(i);n.gemId=i,n.gemType=t.gemType,n.img=gemType2Img(n.gemType),n.power=gemType2Power(n.gemType),n.price=big2number(t.price)/1e6,n.owner=localTronweb.address.fromHex(t.gemowner),n.petId=big2number(t.petId),vue_pets.updateMarketGem(n)}}),i)}vue_pets.removeFromMarket(2,n)}})),getMarketPets((function(e){if(e.result){let t=e.retobj,n={};for(let e=0;e<t.length;e++){let i=big2number(t[e]);n[i]=!0,getPetBasic(i,(function(e){if(e.result){let t=vue_pets.getPet(i);t.petId=i,t.rpId=big2number(e.retobj.rpId),t.power=big2number(e.retobj.power),t.price=big2number(e.retobj.price)/1e6,t.img="pet"+t.rpId+".png",vue_pets.updateMarketPet(t)}}))}vue_pets.removeFromMarket(1,n)}}))}async function petContractWritePay(e,t,n,i,o){if(!(n<=0)&&tronlinkWeb)try{let a,s=await tronlinkWeb.contract().at(petcontract),l={feeLimit:1e8,callValue:0,tokenId:contractTokenId,tokenValue:1e6*n,shouldPollResponse:!1};a=null!=i&&null!=o?await s[e](i,o).send(l):null!=i?await s[e](i).send(l):await s[e]().send(l),t&&t({result:!0,retobj:a})}catch(e){console.log(e)}}async function petContractWrite(e,t,n,i){if(tronlinkWeb)try{let o,a=await tronlinkWeb.contract().at(petcontract),s={feeLimit:1e8,callValue:0,tokenId:"",tokenValue:0,shouldPollResponse:!1};o=null!=n&&null!=i?await a[e](n,i).send(s):null!=n?await a[e](n).send(s):await a[e]().send(s),t&&t({result:!0,retobj:o})}catch(e){console.log(e)}}async function petContractRead(e,t,n,i){let o=localTronweb;if(tronlinkWeb&&(o=tronlinkWeb),o)try{let a,s=await o.contract().at(petcontract);a=null!=n&&null!=i?await s[e](n,i).call():null!=n?await s[e](n).call():await s[e]().call(),t&&t({result:!0,retobj:a})}catch(t){console.log(t+" "+e)}else console.log("NO tronweb")}async function readPetMetrics(){getUserMetrics((function(e){if(e.result){vue_pets.myGemsCnt,vue_pets.myPetsCnt;vue_pets.myGemsCnt=big2number(e.retobj.gemCnt),vue_pets.myPetsCnt=big2number(e.retobj.petCnt),vue_pets.nextPickPrice=big2number(e.retobj.pickPrice)/1e6}})),petContractRead("getMetrics",(function(e){e.result?(vue_pets.totalEvents=big2number(e.retobj.eventCnt),vue_pets.totalGems=big2number(e.retobj.gemCnt),vue_pets.totalPets=big2number(e.retobj.petCnt),vue_pets.readAllPets(vue_pets.block%10==0),vue_pets.totalMarketGems=big2number(e.retobj.marketGemCnt),vue_pets.totalMarketPets=big2number(e.retobj.marketPetCnt)):console.log(e.retobj)}))}async function getUserMetrics(e){if(tronlinkWeb){return petContractRead("getUserMetrics",e,tronlinkWeb.defaultAddress.base58)}}async function getMarketPets(e){return petContractRead("getMarketPets",e)}async function getMyPets(e){if(tronlinkWeb){return petContractRead("getUserPets",e,tronlinkWeb.defaultAddress.base58)}}async function pickPet(e,t){if(tronlinkWeb)return petContractWritePay("pickRandomPet",t,e)}vue_pets=new Vue({el:"#v_pets",data:{searches:[],rawPets:[],marketGems:[],bindGemId:0,selectedPetId:0,myPets:[],myGems:[],marketPets:[],rankingPets:[],rankMaps:{},allPets:[],allGems:[],sellPrice:0,itemName:"",sellIndicator:"",totalRawPets:125,totalPets:0,totalGems:0,petsCntBp:0,myPetsCnt:0,myGemsCnt:0,nextPickPrice:100,totalMarketPets:0,totalMarketGems:0,tokenBalance:0,totalEvents:0,searchPrice:5,searchTimes:5,feedPrice:5,bnGems:{},block:0,findGems:0,searching:!1,claiming:!1,maxBn:0,refreshCB:null},computed:{selectedPetImg:function(){if(0==this.selectePetId)return"";for(let e=0;e<this.myPets.length;e++)if(this.myPets[e].petId==this.selectedPetId)return"./img/pet"+this.myPets[e].rpId+".png";return""},totalPetPower:function(){let e=0;for(let t=0;t<this.rankingPets.length;t++)e+=this.rankingPets[t].power;return e},totalPoweredPet:function(){return this.rankingPets.length}},methods:{buildRawPets:function(){if(0==this.rawPets.length)for(let e=1;e<=this.totalRawPets;e++)this.rawPets.push({desc:"A cute pet",img:"pet"+e+".png",hot:0})},updateMarketGem:function(e){let t=!1;for(let n=0;n<this.marketGems.length;n++)if(this.marketGems[n].gemId==e.gemId){t=!0;break}t||this.marketGems.push(e)},updateMyPet:function(e){let t=!1;for(let n=0;n<this.myPets.length;n++)if(this.myPets[n].petId==e.petId){t=!0;break}t||this.myPets.push(e)},updateMyGem:function(e){let t=!1;for(let n=0;n<this.myGems.length;n++)if(this.myGems[n].gemId==e.gemId){t=!0;break}t||this.myGems.push(e)},updateMarketPet:function(e){let t=!1;for(let n=0;n<this.marketPets.length;n++)if(this.marketPets[n].petId==e.petId){t=!0;break}t||this.marketPets.push(e)},removeFromMarket:function(e,t){if(1==e)for(let e=0;e<this.marketPets.length;e++)t[this.marketPets[e].petId]||(this.marketPets.splice(e,1),e--);else if(2==e)for(let e=0;e<this.marketGems.length;e++)t[this.marketGems[e].gemId]||(this.marketGems.splice(e,1),e--)},pick:function(){tronlinkWeb?this.nextPickPrice>0&&(alleventv.pushWaitingEvent("Picking pet"),this.petsCntBp=this.myPetsCnt,pickPet(this.nextPickPrice,(function(e){alleventv.pushPickPet(e)}))):tronlinkNotConnected()},buy:function(e,t){tronlinkWeb?(alleventv.pushWaitingEvent("Buying pet"),buyPet(e,t,(function(t){alleventv.pushPetCommonEvent("Buy Pet",e,t)}))):tronlinkNotConnected(),console.log(e)},confirmBind:function(){this.selectedPetId>0&&this.bindGemId>0&&(alleventv.pushWaitingEvent("Binding Gem.."),bindPetModalObj.hide(),petContractWrite("bindGem",(function(e){alleventv.pushPetCommonEvent("Bind Gem to Pet",this.bindGemId,e)}),this.bindGemId,this.selectedPetId))},confirmSell:function(){if(this.sellPrice>0){if(1==this.sellObj.type){let e=this.sellObj.id;alleventv.pushWaitingEvent("Selling Pet.."),sellPet(e,Number(this.sellPrice),(function(t){alleventv.pushSellPetGem("Pet",e,t)}))}else{let e=this.sellObj.id;alleventv.pushWaitingEvent("Selling Gem .."),contractSellGem(e,Number(this.sellPrice),(function(t){alleventv.pushSellPetGem("Gem",e,t)}))}petPriceModalObj.hide()}else this.sellIndicator="Sell price must >0"},sell:function(e){this.isSelling(1,e)?(alleventv.pushWaitingEvent("Unselling Pet.."),unsellPet(e,(function(t){alleventv.pushPetCommonEvent("Unsell Pet",e,t)}))):(this.itemName="Pet "+e,this.sellObj={type:1,id:e},delete petPriceModalObj,petPriceModalObj=new bootstrap.Modal(document.getElementById("petPriceModal"),null),petPriceModalObj.show())},release:function(e){console.log(e)},feed:function(e){tronlinkWeb?(alleventv.pushWaitingEvent("Feeding pet"),feedPet(e,(function(t){alleventv.pushFeedPet(e,t)}))):tronlinkNotConnected()},searchGem:function(){tronlinkWeb?(vue_pets.searching=!0,alleventv.pushWaitingEvent("Search Gem.."),petContractWritePay("searchGem",(function(e){alleventv.pushPetCommonEvent("Search Gem",vue_pets.searchTimes,e),vue_pets.searching=!1}),this.searchPrice*this.searchTimes,this.searchTimes)):tronlinkNotConnected()},claimGem:function(){tronlinkWeb?(vue_pets.claiming=!0,petContractWrite("claimGems",(function(e){e.result&&(vue_pets.claiming=!1)}))):tronlinkNotConnected()},buyGem:function(e,t){tronlinkWeb?(alleventv.pushWaitingEvent("Buying Gem.."),petContractWritePay("buyGem",(function(t){alleventv.pushPetCommonEvent("Buy Gem",e,t)}),t,e,1e6*t)):tronlinkNotConnected()},sellGem:function(e){this.isSelling(2,e)?(alleventv.pushWaitingEvent("Unselling Gem.."),petContractWrite("unsellGem",(function(t){alleventv.pushPetCommonEvent("Unsell Gem",e,t)}),e)):(this.itemName="Gem "+e,this.sellObj={type:2,id:e},delete petPriceModalObj,petPriceModalObj=new bootstrap.Modal(document.getElementById("petPriceModal"),null),petPriceModalObj.show())},bindGem:function(e,t){this.isGemBinded(e)?(alleventv.pushWaitingEvent("Unbind Gem.."),petContractWrite("unbindGem",(function(t){alleventv.pushPetCommonEvent("Unbind Gem",e,t)}),e,t)):(this.itemName="Bind Gem "+e+" to",this.bindGemId=e,delete bindPetModalObj,bindPetModalObj=new bootstrap.Modal(document.getElementById("bindPetModal"),null),bindPetModalObj.show())},bindOrUnbind:function(e){return this.isGemBinded(e)?"Unbind":"Bind"},sellOrUnsell:function(e,t){return this.isSelling(e,t)?"Unsell":"Sell"},isGemBinded:function(e){for(let t=0;t<this.myGems.length;t++)if(this.myGems[t].gemId==e)return this.myGems[t].petId>0;return!1},isSelling:function(e,t){if(1==e){for(let e=0;e<this.myPets.length;e++)if(this.myPets[e].petId==t)return 0!=this.myPets[e].price}else for(let e=0;e<this.myGems.length;e++)if(this.myGems[e].gemId==t)return 0!=this.myGems[e].price},smartRefresh:function(){this.refreshCB&&this.refreshCB()},readAllPets:function(e){if(e||this.totalPets!=this.rankingPets.length)for(let e=1;e<=this.totalPets;e++){let t=e;getPetBasic(t,(function(e){let n=vue_pets.getPet(t);n.petId=t,n.rpId=big2number(e.retobj.rpId),n.power=big2number(e.retobj.power),n.price=big2number(e.retobj.price)/1e6,n.img="pet"+n.rpId+".png",vue_pets.rankMaps[t]||n.power>0&&(vue_pets.rankingPets.push(n),vue_pets.rankingPets.sort((function(e,t){return t.power-e.power})),vue_pets.rankMaps[t]=!0)}))}},getGem:function(e){return this.allGems[e]||(this.allGems[e]={}),this.allGems[e]},getPet:function(e){return this.allPets[e]||(this.allPets[e]={}),this.allPets[e]},updateMyPets:function(){getMyPets((function(e){if(e.result){let t=e.retobj;vue_pets.myPets.length!=t.length&&(vue_pets.myPets=[]);for(let e=0;e<t.length;e++){let n=big2number(t[e]);getPetBasic(n,(function(e){if(e.result){let t=vue_pets.getPet(n);t.petId=n,t.rpId=big2number(e.retobj.rpId),t.power=big2number(e.retobj.power),t.price=big2number(e.retobj.price)/1e6,t.img="pet"+t.rpId+".png",vue_pets.updateMyPet(t)}}))}}}))},updateMyGems:function(){petContractRead("getUserGems",(function(e){if(e.result){let t=e.retobj;vue_pets.myGems.length!=t.length&&(vue_pets.myGems=[]);for(let e=0;e<t.length;e++){let n=big2number(t[e]);petContractRead("getGem",(function(e){if(e.result){let t=e.retobj,i=vue_pets.getGem(n);i.gemId=n,i.gemType=t.gemType,i.img=gemType2Img(i.gemType),i.power=gemType2Power(i.gemType),i.price=big2number(t.price)/1e6,i.owner=localTronweb.address.fromHex(t.gemowner),i.petId=big2number(t.petId),vue_pets.updateMyGem(i)}}),n)}}}),tronlinkWeb.defaultAddress.base58)},showMyPetGem:function(){if(!tronlinkWeb)return tronlinkNotConnected();showEle("petsRanking",!1),showEle("petsPick",!1),showEle("petsMarket",!1),showEle("myPetGem",!0),updateMys(),this.refreshCB=updateMys},showPetMarket:function(){showEle("petsRanking",!1),showEle("petsPick",!1),showEle("petsMarket",!0),showEle("myPetGem",!1),updateMarkets(),this.refreshCB=updateMarkets},showPetPicker:function(){showEle("petsRanking",!1),showEle("petsPick",!0),showEle("petsMarket",!1),showEle("myPetGem",!1),this.refreshCB=this.buildRawPets,this.buildRawPets()},showPetRanking:function(){showEle("petsRanking",!0),showEle("petsPick",!1),showEle("petsMarket",!1),showEle("myPetGem",!1),readPetMetrics(),this.refreshCB=readPetMetrics}}}),vue_pets.showPetRanking();const FEEDPRICE=5;async function feedPet(e,t){if(tronlinkWeb)return petContractWritePay("feedPet",t,5,e)}async function getPetBasic(e,t){if(localTronweb)return petContractRead("getPetBasic",t,e)}async function getPetMore(e,t){if(localTronweb)return petContractRead("getPetMore",t,e)}async function sellPet(e,t,n){tronlinkWeb?t>0&&petContractWrite("sellPet",n,e,1e6*t):tronlinkNotConnected()}async function contractSellGem(e,t,n){tronlinkWeb?t>0&&petContractWrite("sellGem",n,e,1e6*t):tronlinkNotConnected()}async function unsellPet(e,t){tronlinkWeb?petContractWrite("unsellPet",t,e):tronlinkNotConnected()}async function buyPet(e,t,n){tronlinkWeb?petContractWritePay("buyPet",n,t,e,1e6*t):tronlinkNotConnected()}async function instantContractWritePay(e,t,n,i,o){if(!(n<=0)&&tronlinkWeb)try{let a,s=await tronlinkWeb.contract().at(instantcontract),l={feeLimit:1e8,callValue:0,tokenId:contractTokenId,tokenValue:1e6*n,shouldPollResponse:!1};a=null!=i&&null!=o?await s[e](i,o).send(l):null!=i?await s[e](i).send(l):await s[e]().send(l),t&&t({result:!0,retobj:a})}catch(e){console.log(e)}}async function instantContractWrite(e,t,n,i){if(tronlinkWeb)try{let o,a=await tronlinkWeb.contract().at(instantcontract),s={feeLimit:1e8,callValue:0,tokenId:"",tokenValue:0,shouldPollResponse:!1};o=null!=n&&null!=i?await a[e](n,i).send(s):null!=n?await a[e](n).send(s):await a[e]().send(s),t&&t({result:!0,retobj:o})}catch(e){console.log(e)}}async function instantContractTest(e,t,n,i,o){if(e)try{let a,s=await e.contract().at(instantcontract),l={feeLimit:1e8,callValue:0,tokenId:"",tokenValue:0,shouldPollResponse:!1};a=null!=i&&null!=o?await s[t](i,o).send(l):null!=i?await s[t](i).send(l):await s[t]().send(l),n&&n({result:!0,retobj:a})}catch(e){console.log(e)}}async function instantContractRead(e,t,n,i){let o=localTronweb;if(tronlinkWeb&&(o=tronlinkWeb),o)try{let a,s=await o.contract().at(instantcontract);a=null!=n&&null!=i?await s[e](n,i).call():null!=n?await s[e](n).call():await s[e]().call(),t&&t({result:!0,retobj:a})}catch(t){console.log(t+" "+e)}else console.log("NO tronweb")}uefa_vue=new Vue({el:"#uefa2021",data:{desc:"NBA Playoffs 2021",items:{1:{name:"Man. City",img:"mc.png"},2:{name:"Dortmund",img:"dtmd.png"},3:{name:"Real Madrid",img:"hm.png"},4:{name:"Liverpool",img:"lwp.png"},5:{name:"Bayern",img:"br.png"},6:{name:"Paris",img:"bl.png"},7:{name:"Porto",img:"bet.png"},8:{name:"Chelsea",img:"qex.png"},9:{name:"Real Madrid",img:"hm.png"},10:{name:"Chelsea",img:"qex.png"},11:{name:"Paris",img:"bl.png"},12:{name:"Man. City",img:"mc.png"},13:{name:"Man. City",img:"mc.png"},14:{name:"Chelsea",img:"qex.png"},15:{name:"Clippers",img:"LAC_logo.svg"},16:{name:"Suns",img:"PHX_logo.svg"},17:{name:"Bucks",img:"MIL_logo.svg"},18:{name:"Hawks",img:"ATL_logo.svg"}},hisgroups:[{title:"Final",cid:7,leg1:"0-1",leg2:"",winner:"Chelsea",bonus:0,votes:0,winItemId:0,canClaimWin:!0,items:[13,14]},{title:"Semi-Final 1",cid:5,leg1:"1-1",leg2:"0-2",winner:"Chelsea",bonus:0,votes:0,winItemId:0,canClaimWin:!0,items:[9,10]},{title:"Semi-Final 2",cid:6,leg1:"1-2",leg2:"0-2",winner:"Man. City",bonus:0,votes:0,winItemId:0,canClaimWin:!0,items:[11,12]},{title:"Quater-Final 1",cid:1,leg1:"2-1",leg2:"2-1",winner:"Man. City",bonus:0,votes:0,winItemId:0,canClaimWin:!0,items:[1,2]},{title:"Quater-Final 2",cid:2,leg1:"3-1",leg2:"0-0",winner:"Real Madrid",bonus:0,votes:0,winItemId:0,canClaimWin:!0,items:[3,4]},{title:"Quater-Final 3",cid:3,leg1:"2-3",leg2:"1-0",winner:"Paris",bonus:0,votes:0,winItemId:0,canClaimWin:!0,items:[5,6]},{title:"Quater-Final 4",cid:4,leg1:"0-2",leg2:"1-0",winner:"Chelsea",bonus:0,votes:0,winItemId:0,canClaimWin:!0,items:[7,8]}],groups:[{title:"WEST Final",cid:8,leg1:"0 - 2",leg2:"",winner:"",bonus:0,votes:0,winItemId:0,canClaimWin:!1,items:[15,16]},{title:"EAST Final",cid:9,leg1:"0 - 0",leg2:"",winner:"",bonus:0,votes:0,winItemId:0,canClaimWin:!1,items:[17,18]}],claimingCids:{}},methods:{updateHisGroups:function(e){for(let t=0;t<this.hisgroups.length;t++){let n=this.hisgroups[t].cid,i=this.hisgroups[t];instantContractRead("getCateDetails",(function(e){e.result&&(i.winItemId=big2number(e.retobj.winItem),i.votes=big2number(e.retobj.votes)/1e6,i.expire=big2number(e.retobj.expireTs),i.bonus=big2number(e.retobj.totalToken)/1e6)}),n);for(let n=0;n<this.hisgroups[t].items.length;n++){let i=this.hisgroups[t].items[n];this.items[i]||(this.items[i]={});let o=this.items[i];instantContractRead("getItemDetails",(function(e){if(e.result){o.votes=big2number(e.retobj.itemVotes)/1e6,o.uvotes=big2number(e.retobj.uVotes)/1e6,o.expire=big2number(e.retobj.expireTs),o.ltStr=uefa_vue.leftTime(o.expire);const t=(Date.now()/1e3).toFixed(0);o.active=Number(t)<o.expire,uefa_vue.$forceUpdate()}}),i,e)}}},updateGroups:function(e){for(let t=0;t<this.groups.length;t++){let n=this.groups[t].cid,i=this.groups[t];instantContractRead("getCateDetails",(function(e){e.result&&(i.winItemId=big2number(e.retobj.winItem),i.votes=big2number(e.retobj.votes)/1e6,i.expire=big2number(e.retobj.expireTs),i.bonus=big2number(e.retobj.totalToken)/1e6)}),n);for(let n=0;n<this.groups[t].items.length;n++){let i=this.groups[t].items[n];this.items[i]||(this.items[i]={});let o=this.items[i];instantContractRead("getItemDetails",(function(e){if(e.result){o.votes=big2number(e.retobj.itemVotes)/1e6,o.uvotes=big2number(e.retobj.uVotes)/1e6,o.expire=big2number(e.retobj.expireTs),o.ltStr=uefa_vue.leftTime(o.expire);const t=(Date.now()/1e3).toFixed(0);o.active=Number(t)<o.expire,uefa_vue.$forceUpdate()}}),i,e)}}},leftTime:function(e){let t=Date.now()/1e3;if(t=t.toFixed(0),t>e)return"Expired";let n=e-t,i="";if(n>86400){let e=n/86400;e=e.toFixed(0),1==e?i+="1 day":(i+=e,i+="+ days")}else if(n>3600){let e=n/3600;e=e.toFixed(0),1==e?i+="1+ hour ":(i+=e,i+="+ hours ")}else{let e=n/60;e=e.toFixed(0),1==e?i+="1+ min ":(i+=e,i+="+ mins ")}return i},itemName:function(e){return this.items[e].name},itemImg:function(e){return this.items[e].img},voteItem:function(e){tronlinkWeb?(votemodalv.reset(),votemodalv.tokenBalance=walletv.tokenBalance,votemodalv.itemId=e,votemodalv.itemName=this.itemName(e),votemodalv.isVote=!0,votemodalv.confirmCB=uefa_vue.confirmVote,delete voteModalObj,(voteModalObj=new bootstrap.Modal(document.getElementById("voteModal"),null)).show()):tronlinkNotConnected()},confirmVote:function(e,t){t>0&&(alleventv.pushWaitingEvent("Voting"),instantContractWritePay("vote",(function(n){alleventv.pushPetCommonEvent("Vote "+uefa_vue.items[e].name+" ",t,n),vue_allbets.smartRefresh()}),t,e)),voteModalObj.hide()},claimWin:function(e){alleventv.pushWaitingEvent("Voting"),this.claimingCids[e]=!0,instantContractWrite("claimWin",(function(t){uefa_vue.claimingCids[e]=!1,alleventv.pushPetCommonEvent("Claim Bonus",e,t)}),e)}}});const maxOrders=5;function readUserOrders(){dexGetOrders((function(e){if(e.result){let t=e.retobj,n=0;for(;n<t.length;n++){let e=big2number(t[n]);dexRead("getOrderDetails",(function(t){if(t.result){let n=t.retobj,i={oid:e};if(i.price=big2number(n.price),i.amount=big2number(n.amount),i.lamount=big2number(n.leftamout),i.ts=big2number(n.ts),i.tsdone=big2number(n.tsdone),i.type=n.otype,i.lamount>0)dexmyorders.ordersMap[e]?dexmyorders.orders[dexmyorders.ordersMap[e]-1]=i:(dexmyorders.orders.unshift(i),dexmyorders.ordersMap[e]=dexmyorders.orders.length);else{let t=dexmyorders.ordersMap[e];t>0&&(dexmyorders.orders.splice(t-1,1),dexmyorders.ordersMap[e]=0)}}}),e)}}}))}function readBuyPrices(){dexRead("getBuyPrices",(function(e){if(e.result){e=e.retobj;let t=0;for(;t<e.length;t++){let n=vue_dex.buyorders[t],i=big2number(e[t]);n.price=i,n.dprice=n.price/1e6,vue_dex.ordersMap[i]=n,dexRead("getBuyAmount",(function(e){e.result&&(vue_dex.ordersMap[i].amount=big2number(e.retobj))}),i)}for(;t<5;t++)vue_dex.buyorders[t].price=null,vue_dex.buyorders[t].dprice="-",vue_dex.buyorders[t].amount=null}}))}function readSellPrices(){dexRead("getSellPrices",(function(e){if(!e.result)return;e=e.retobj;let t=0;for(;t<e.length;t++){let n=vue_dex.sellorders[5-t-1];n.price=big2number(e[t]),n.dprice=n.price/1e6;let i=n.price;n.amount=0,vue_dex.sordersMap[i]=n,dexRead("getSellAmount",(function(e){e.result&&(vue_dex.sordersMap[i].amount=big2number(e.retobj))}),i)}for(;t<5;t++)vue_dex.sellorders[5-t-1].price=null,vue_dex.sellorders[5-t-1].dprice="-",vue_dex.sellorders[5-t-1].amount=null}))}function showAllEvents(){allEventsObj=new bootstrap.Modal(ele("eventsModal")),allEventsObj.show()}function createNew(){getRealTronweb()?(createmodalv.trxBalance=walletv.trxBalance,createmodalv.costOfCreate=tongjiv.costOfCreate,createmodalv.cateSelected=defaultCateId,(createModalObj=new bootstrap.Modal(document.getElementById("createModal"))).show()):tronlinkNotConnected()}function claimReward(e){getRealTronweb()?(tongjiv.claiming=!0,alleventv.pushWaitingEvent("Claiming"),contractClaimReward(null,e)):tronlinkNotConnected()}function readItem(e){contractRead("getItem",(function(t){let n={};n.id=e,n.name=t[0],n.rank=e,n.voting=!1,n.votes=big2number(t[1])/1e6,n.cateId=104==e||105==e||96==e?7:big2number(t[2]),n.creator=getLocalTronweb().address.fromHex(t[3]),insertIntoRanks(n)&&(presetranks[e]=n)}),e,null)}function createRanksOfCate(e){if(defaultCateId==e)return;defaultCateId=e,walletv.cateId=e,rankv.switchCateId(e);for(let t=0;t<presetranks.length;t++)presetranks[t]&&presetranks[t].cateId==e&&insertIntoRanks(presetranks[t]);contractRead("getCateItemsId",(function(e){for(let t=0;t<e.length;t++){readItem(big2number(e[t]))}}),defaultCateId)}function loadHisEvents(){if(tongjiv.totalevents>eventStart){let e=eventStart;for(alleventv.loadingEvents=!0;e<tongjiv.totalevents;e++)contractRead("getUpdateEvent",(function(e){let t={};t.caller=getLocalTronweb().address.fromHex(e[0]),t.type=big2number(e[1]),t.itemId=big2number(e[2]),t.amount=big2number(e[3])/1e6,t.total=big2number(e[4])/1e6,t.param2="",t.details=t.caller,alleventv.updateEventResult(t),alleventv.loadingEvents=!1}),e);eventStart=tongjiv.totalevents}}function readMetrics(){contractRead("getMetrics",(function(e){tongjiv.totalvotes=big2number(e[0])/1e6,tongjiv.totalrewards=big2number(e[1])/1e6,tongjiv.totalitems=big2number(e[2])-1,presetranks.length=tongjiv.totalitems+1,tongjiv.costOfCreate=big2number(e[3]),tongjiv.createtext="Cost "+tongjiv.costOfCreate/1e6+" TRX to create new item",createmodalv.indicator=tongjiv.createtext,tongjiv.myvotes=big2number(e[4])/1e6,tongjiv.exrate=big2number(e[5]),tongjiv.airdropusers=big2number(e[6]),tongjiv.totalusers=big2number(e[7]),tongjiv.totalevents=big2number(e[8]),alleventv.pendingLoadEvents=tongjiv.totalevents-eventStart,tongjiv.loading=!1,walletv.eventcnt=alleventv.pendingLoadEvents}),null,null,!0)}function voteItemOnLink(e){console.log("vote item"+e)}function unVoteItemOnLink(e){console.log("unvote item"+e)}function updateItemVote(e,t,n){if(e=Number(e),rankv.itemsMap.has(e)){let i=presetranks[e].votes;n&&i<t&&(presetranks[e].votes=t,i!=t&&(rankv.allItems.sort((function(e,t){return t.votes-e.votes})),rankv.setCurPage()))}else presetranks[e]&&(presetranks[e].votes=t)}function insertIntoRanks(e){if(e.cateId!=rankv.cateId)return!0;if(rankv.itemsMap.has(e.id)){let t=presetranks[e.id].votes;return presetranks[e.id].votes=e.votes,t!=e.votes?rankv.allItems.sort((function(e,t){return t.votes-e.votes})):rankv.setCurPage(),!1}return rankv.allItems.push(e),rankv.allItems.sort((function(e,t){return t.votes-e.votes})),rankv.setCurPage(),rankv.itemsMap.set(e.id,!0),!0}function requestVOTEIT(){walletv.tlconnected?(voteitModalObj=new bootstrap.Modal(document.getElementById("voteitModal"),null)).show():tronlinkNotConnected()}function rankFilter(){var e,t;for(e=document.getElementById("rankFilterInput").value.toUpperCase(),t=0;t<rankv.items.length;t++){let n=document.getElementById("rank_"+rankv.items[t].id),i=document.getElementById("p_rank_"+rankv.items[t].id);txtValue=n.innerText,txtValue.toUpperCase().indexOf(e)>-1?i.style.display="":i.style.display="none"}}function routeByHash(){let e=window.location.hash,t=e.indexOf("cate=");-1!=t?(showEle("v_ranks",!0),showEle("v_itemdetail",!1),vue_itemdetail.show=!1,createRanksOfCate(Number(e.substr(t+5)))):(t=e.indexOf("item="),-1!=t?(showEle("v_ranks",!1),showEle("v_itemdetail",!0),showItem(Number(e.substr(t+5)))):(alleventv.mode=1,showEle("v_ranks",!0),showEle("v_itemdetail",!1),createRanksOfCate(1)))}function backFromItemDetail(e){showEle("v_ranks",!0),showEle("v_itemdetail",!1)}function showEle(e,t){var n=document.getElementById(e);n&&(t?n.classList.remove("vhide"):n.classList.add("vhide"))}function clickSellItem(e){let t=Number(e.getAttribute("idx"));vue_dex.buyPrice=vue_dex.sellorders[t].price/1e6,vue_dex.buyAmount=vue_dex.sellorders[t].amount/1e6}function clickBuyItem(e){let t=Number(e.getAttribute("idx"));vue_dex.sellPrice=vue_dex.buyorders[t].price/1e6,vue_dex.sellAmount=vue_dex.buyorders[t].amount/1e6}function setCookie(e,t,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="expires="+i.toUTCString();document.cookie=e+"="+t+";"+o+";path=/"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""}readMetrics(),setInterval((async()=>{readMetrics(),getResource(contractOwner,(function(e){walletv.energyLeft=e}))}),5e3),walletv.connectWallet(),routeByHash(),window.onpopstate=function(e){routeByHash()};
